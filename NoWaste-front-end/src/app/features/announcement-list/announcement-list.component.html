<!-- Search bar and filters -->
<div class="bg-[#264653]/5 backdrop-blur-md rounded-2xl p-4 mb-8 shadow-lg border border-[#264653]/10">
  <div class="flex flex-col lg:flex-row gap-4 items-center">
    <div class="relative flex-grow">
      <span class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
        <svg class="w-5 h-5 text-[#E9C46A]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"
                stroke-linecap="round" stroke-linejoin="round" stroke-width="2"/>
        </svg>
      </span>
      <input
        [(ngModel)]="searchQuery"
        (input)="applyFilters()"
        class="block w-full pl-12 pr-4 py-3 border border-[#264653]/20 rounded-xl bg-[#264653]/10 backdrop-blur-sm text-[#264653] placeholder-[#264653]/60 focus:ring-2 focus:ring-[#E9C46A] focus:border-transparent transition-all duration-300"
        placeholder="Search announcements..."
      />
    </div>

    <div class="flex flex-wrap gap-3 w-full lg:w-auto justify-center lg:justify-end">
      <div
        class="flex items-center bg-[#264653]/10 backdrop-blur-sm rounded-xl px-4 py-2.5 text-[#264653] border border-[#264653]/10 hover:border-[#264653]/20 transition-colors">
        <span class="mr-2 text-[#264653]/70">Sort by</span>
        <select
          (change)="applyFilters()"
          [(ngModel)]="sortBy"
          class="bg-transparent border-none focus:ring-0 text-[#264653] cursor-pointer"
        >
          <option class="bg-[#264653] text-[#264653]" value="newest">Newest</option>
          <option class="bg-[#264653] text-[#264653]" value="oldest">Oldest</option>
          <option class="bg-[#264653] text-[#264653]" value="title">Title (A-Z)</option>
        </select>
      </div>

      <div
        class="flex items-center bg-[#264653]/10 backdrop-blur-sm rounded-xl px-4 py-2.5 text-[#264653] border border-[#264653]/10 hover:border-[#264653]/20 transition-colors">
        <span class="mr-2 text-[#264653]/70">Status</span>
        <select
          (change)="applyFilters()"
          [(ngModel)]="filterStatus"
          class="bg-transparent border-none focus:ring-0 text-[#264653] cursor-pointer"
        >
          <option class="bg-[#264653] text-[#264653]" value="all">All</option>
          <option *ngFor="let status of productStatuses" [value]="status" class="bg-[#264653] text-[#264653]">
            {{ status }}
          </option>
        </select>
      </div>

      <button
        (click)="toggleMyAnnouncements()"
        [ngClass]="showOnlyMine ? 'bg-[#E76F51] hover:bg-[#E76F51]/90 border-[#E76F51]/50' : 'bg-[#264653]/10 hover:bg-[#264653]/20 border-[#264653]/10 hover:border-[#264653]/30'"
        class="flex items-center rounded-xl px-4 py-2.5 text-[#264653] transition-all border"
      >
        <svg *ngIf="showOnlyMine" class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path d="M5 13l4 4L19 7" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
        </svg>
        <span>{{ showOnlyMine ? 'My Announcements' : 'All Announcements' }}</span>
      </button>

      <button
        (click)="openAddAnnouncementModal()"
        class="flex items-center gap-2 bg-[#E9C46A] hover:bg-[#E9C46A]/90 text-[#264653] font-medium py-2.5 px-5 rounded-xl transition-all shadow-md hover:shadow-xl"
      >
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path d="M12 4.5v15m7.5-7.5h-15" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"/>
        </svg>
        <span>Add New</span>
      </button>
    </div>
  </div>
</div>

<!-- Categories -->
<div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-8 gap-4">
  <div class="flex items-center text-[#264653]">
    <h2 class="text-xl font-semibold mr-4">Category</h2>
    <div class="flex bg-[#264653]/10 backdrop-blur-sm rounded-full overflow-hidden shadow-md">
      <button class="px-5 py-2 bg-[#2A9D8F] text-[#264653] font-medium hover:bg-[#2A9D8F]/90 transition-colors">
        All
      </button>
      <button class="px-5 py-2 text-[#264653]/80 hover:bg-[#264653]/10 transition-colors">Items</button>
      <button class="px-5 py-2 text-[#264653]/80 hover:bg-[#264653]/10 transition-colors">Collection</button>
      <button class="px-5 py-2 text-[#264653]/80 hover:bg-[#264653]/10 transition-colors">Users</button>
    </div>
  </div>

  <div class="text-[#264653] font-medium bg-[#264653]/10 backdrop-blur-sm px-4 py-2 rounded-lg border border-[#264653]/10">
    <span *ngIf="!isLoading">Showing <span class="text-[#E9C46A]">{{ filteredAnnouncements.length }}</span> results</span>
  </div>
</div>

<!-- Loader -->
<div *ngIf="isLoading" class="flex justify-center items-center py-16">
  <div class="relative">
    <div class="animate-spin rounded-full h-16 w-16 border-4 border-[#E9C46A]/30"></div>
    <div class="animate-spin rounded-full h-16 w-16 border-t-4 border-l-4 border-[#E9C46A] absolute top-0"></div>
  </div>
  <p class="text-[#264653]/70 ml-6 text-lg">Loading announcements...</p>
</div>

<!-- Empty state -->
<div *ngIf="!isLoading && filteredAnnouncements.length === 0" class="text-center py-16">
  <div class="bg-[#264653]/10 backdrop-blur-md p-8 rounded-xl max-w-lg mx-auto border border-[#264653]/10 shadow-xl">
    <div class="w-20 h-20 mx-auto mb-6 rounded-full bg-[#E9C46A]/20 flex items-center justify-center">
      <svg class="w-10 h-10 text-[#E9C46A]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path d="M3.75 9.776c.112-.017.227-.026.344-.026h15.812c.117 0 .232.009.344.026m-16.5 0a2.25 2.25 0 00-1.883 2.542l.857 6a2.25 2.25 0 002.227 1.932H19.05a2.25 2.25 0 002.227-1.932l.857-6a2.25 2.25 0 00-1.883-2.542m-16.5 0V6A2.25 2.25 0 016 3.75h3.879a1.5 1.5 0 011.06.44l2.122 2.12a1.5 1.5 0 001.06.44H18A2.25 2.25 0 0120.25 9v.776"
              stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
    </div>
    <h3 class="text-2xl font-medium text-[#264653] mb-2">No announcements found</h3>
    <p class="text-[#264653]/70 mb-8 max-w-md mx-auto">Try changing your search criteria or filters, or create a new
      announcement to get started.</p>
    <button (click)="openAddAnnouncementModal()"
            class="inline-flex items-center gap-2 bg-[#E9C46A] hover:bg-[#E9C46A]/90 text-[#264653] font-medium py-3 px-8 rounded-xl shadow-md hover:shadow-xl transition-all">
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path d="M12 4.5v15m7.5-7.5h-15" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"/>
      </svg>
      Create Announcement
    </button>
  </div>
</div>

<!-- Announcements grid using the new item component -->
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
  <app-announcement-card
    *ngFor="let announcement of filteredAnnouncements | slice:(currentPage-1)*pageSize:currentPage*pageSize"
    [announcement]="announcement"
    [isOwner]="isOwner(announcement)"
    (edit)="openEditAnnouncementModal($event)"
    (delete)="confirmDelete($event)"
    (view)="viewItemDetails($event)">

    <!-- Custom image content using content projection -->
    <ng-container image-content>
      <div class="absolute inset-0 bg-gradient-to-t from-[#264653]/90 via-[#264653]/30 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 z-10"></div>
    </ng-container>
  </app-announcement-card>
</div>

<!-- Pagination -->
<div *ngIf="filteredAnnouncements.length > 0" class="flex justify-center mt-10">
  <nav class="flex items-center gap-1">
    <button
      (click)="changePage(currentPage - 1)"
      [disabled]="currentPage === 1"
      class="p-2 rounded-lg text-[#264653] border border-[#264653]/10 disabled:opacity-50"
    >
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path d="M15.75 19.5L8.25 12l7.5-7.5" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"/>
      </svg>
    </button>

    <div *ngFor="let page of getPageNumbers()" class="flex">
      <button
        (click)="changePage(page)"
        [ngClass]="currentPage === page ? 'bg-[#E9C46A] text-[#264653] border-[#E9C46A]/50' : 'bg-[#264653]/10 text-[#264653] border-[#264653]/10'"
        class="w-10 h-10 rounded-lg flex items-center justify-center border hover:bg-[#264653]/20 transition-colors"
      >
        {{ page }}
      </button>
    </div>

    <button
      (click)="changePage(currentPage + 1)"
      [disabled]="currentPage === totalPages"
      class="p-2 rounded-lg text-[#264653] border border-[#264653]/10 disabled:opacity-50"
    >
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path d="M8.25 4.5l7.5 7.5-7.5 7.5" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"/>
      </svg>
    </button>
  </nav>
</div>
